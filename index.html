<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gửi Em - XP Love Edition</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Tahoma:wght@400;700&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;600&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Press+Start+2P&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap');

        body {
            background-color: #000;
            overflow: hidden;
            font-family: 'Tahoma', sans-serif;
            user-select: none;
            cursor: default;
        }

        /* --- BOOT SCREEN --- */
        #boot-screen {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: black; color: #ddd;
            font-family: 'Fira Code', monospace; padding: 20px;
            z-index: 99999; display: flex; flex-direction: column;
            font-size: 14px;
        }

        /* --- BSOD --- */
        #bsod {
            display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: #0000aa; color: white;
            font-family: 'Fira Code', monospace; padding: 50px;
            z-index: 100000; cursor: none;
        }

        /* --- DESKTOP --- */
        #desktop {
            background: url('https://upload.wikimedia.org/wikipedia/en/2/27/Bliss_%28Windows_XP%29.png') no-repeat center center/cover;
            height: 100vh; width: 100vw; position: relative; display: none;
            transition: background 1s ease;
        }

        /* --- ICONS --- */
        .icon-grid {
            display: flex; flex-direction: column; flex-wrap: wrap;
            height: calc(100vh - 40px); width: fit-content; padding: 10px; gap: 20px;
            position: relative; z-index: 50;
        }

        .desktop-icon {
            width: 80px; display: flex; flex-direction: column; align-items: center;
            text-align: center; cursor: pointer; color: white;
            text-shadow: 1px 1px 2px rgba(0,0,0,1); font-size: 11px;
            margin-bottom: 5px; position: relative;
        }
        .desktop-icon:hover { background-color: rgba(11, 97, 255, 0.4); outline: 1px dotted rgba(255, 255, 255, 0.5); border-radius: 2px; }
        
        .xp-icon {
            font-size: 36px;
            margin-bottom: 5px;
            filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.5));
            transition: transform 0.1s;
        }
        .desktop-icon:hover .xp-icon { transform: scale(1.1); }
        
        .icon-computer { color: #5dade2; text-shadow: 0 0 2px #2e86c1; }
        .icon-folder { color: #f4d03f; text-shadow: 0 0 2px #d4ac0d; }
        .icon-trash { color: #d5dbdb; }
        .icon-ie { color: #3498db; background: white; border-radius: 50%; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .icon-game { color: #e74c3c; }
        .icon-notepad { color: #fdfefe; text-shadow: 0 0 2px #bdc3c7; }
        .icon-music { color: #e67e22; }
        .icon-calc { color: #a569bd; }
        .icon-chrome-bg { background: white; border-radius: 50%; width: 36px; height: 36px; display: flex; align-items: center; justify-content: center; }
        .icon-chrome { color: #ea4335; font-size: 24px; }

        /* --- WINDOWS --- */
        .window {
            position: absolute; background: #ece9d8;
            border-radius: 5px 5px 0 0; box-shadow: 4px 4px 10px rgba(0,0,0,0.5);
            display: none; flex-direction: column; overflow: hidden;
            border: 1px solid #00138c; z-index: 1000;
        }

        .window-header {
            background: linear-gradient(to bottom, #0058ee 0%, #3593ff 4%, #288eec 6%, #127dff 8%, #0369fc 10%, #0262ee 14%, #0057e5 20%, #0054e3 24%, #0055ea 56%, #0052e0 66%, #004ce0 76%, #0047d9 86%, #0042d4 92%, #003cc5 94%, #0036c0 100%);
            padding: 3px 5px; display: flex; justify-content: space-between; align-items: center; height: 28px; cursor: grab; flex-shrink: 0;
        }
        .window-title { color: white; font-weight: bold; font-size: 12px; text-shadow: 1px 1px #000; display: flex; align-items: center; pointer-events: none; }
        .win-btn-close {
            width: 21px; height: 21px; background: linear-gradient(to bottom, #e07b7b 0%, #d84545 10%, #e07b7b 100%);
            border: 1px solid white; border-radius: 3px; display: flex; justify-content: center; align-items: center; cursor: pointer;
        }
        .win-btn-close i { color: white; font-size: 12px; }

        /* --- APP STYLES --- */
        
        /* Confession */
        #secret-window { width: 90%; max-width: 600px; height: 70vh; top: 45% !important; left: 50% !important; transform: translate(-50%, -50%) !important; }
        #secret-window .window-body { padding: 0; background: black; flex: 1; overflow-y: auto; }
        .terminal-content { padding: 15px; color: #00ff41; font-family: 'Fira Code', monospace; }

        /* Snake */
        #snake-window { width: 320px; height: 380px; top: 20%; left: 20%; background: #222; }
        canvas { background: #000; border: 2px solid #555; display: block; margin: 0 auto; }
        .score-board { color: #0f0; font-family: 'Press Start 2P', cursive; font-size: 10px; text-align: center; padding: 5px; }

        /* Notepad */
        #notepad-window { width: 300px; height: 300px; top: 10%; right: 10%; }
        #notepad-window .window-body { padding: 0; display: flex; flex-direction: column; flex: 1; background: white; }
        .menu-bar { background: #ece9d8; padding: 2px 5px; font-size: 11px; border-bottom: 1px solid #a0a0a0; flex-shrink: 0; }
        .notepad-area { flex: 1; width: 100%; border: none; padding: 5px; font-family: 'Consolas', monospace; resize: none; outline: none; box-sizing: border-box; display: block; }

        /* Calc */
        #calc-window { width: 220px; top: 40%; left: 60%; background: #ece9d8; }
        .calc-display { background: white; border: 1px solid #7f9db9; height: 30px; margin: 10px; text-align: right; padding: 5px; font-family: monospace; font-size: 16px; }
        .calc-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 3px; padding: 0 10px 10px 10px; }
        .calc-btn { height: 30px; font-size: 12px; cursor: pointer; border: 1px solid #fff; border-right-color: #000; border-bottom-color: #000; background: #f0f0f0; }
        .calc-btn:active { border-color: #000 #fff #fff #000; }

        /* Winamp - Playlist Style */
        #winamp-window { width: 300px; height: auto; top: 60%; left: 10%; background: #222; border: 2px solid #555; border-radius: 0; color: #0f0; font-family: sans-serif; }
        .winamp-visualizer { height: 40px; background: #000; margin: 5px 0; display: flex; align-items: flex-end; justify-content: space-between; padding: 0 2px; border: 1px inset #555; }
        .bar { width: 8px; background: #0f0; transition: height 0.1s; }
        .song-title-display { background: #000; color: #0f0; border: 1px solid #555; font-size: 11px; padding: 4px; width: 100%; font-family: monospace; margin-bottom: 5px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        
        .winamp-btn { cursor: pointer; color: #bbb; transition: all 0.2s; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; border: 1px solid #444; background: #333; border-radius: 50%; }
        .winamp-btn:hover { color: white; border-color: #888; background: #444; transform: scale(1.1); }
        .winamp-btn:active { transform: scale(0.9); }
        .winamp-btn.play-btn { color: #0f0; border-color: #060; }
        .winamp-btn.stop-btn { color: #f00; border-color: #600; }

        /* Chrome Browser */
        #chrome-window { width: 900px; height: 600px; top: 5%; left: 5%; background: #fff; font-family: 'Roboto', sans-serif; }
        .chrome-toolbar { background: #f1f3f4; padding: 8px; display: flex; align-items: center; border-bottom: 1px solid #e0e0e0; gap: 10px; flex-shrink: 0; }
        .chrome-url-bar { flex: 1; background: #fff; border: 1px solid #ccc; border-radius: 20px; padding: 5px 15px; font-size: 12px; color: #333; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .chrome-body { flex: 1; display: flex; flex-direction: column; overflow: hidden; position: relative; }
        
        .chrome-view { width: 100%; height: 100%; display: flex; flex-direction: column; overflow-y: auto; background: white; }
        .hidden-view { display: none !important; }

        /* Search View */
        .chrome-search-view { align-items: center; justify-content: center; padding: 20px; }
        .google-logo { font-size: 60px; font-weight: bold; margin-bottom: 20px; user-select: none; }
        .google-blue { color: #4285f4; } .google-red { color: #ea4335; } .google-yellow { color: #fbbc05; } .google-green { color: #34a853; }
        .search-box { width: 80%; max-width: 500px; border: 1px solid #dfe1e5; border-radius: 24px; padding: 12px 20px; display: flex; align-items: center; box-shadow: 0 1px 6px rgba(32,33,36,0.1); }
        .search-box:hover { box-shadow: 0 1px 6px rgba(32,33,36,0.28); }
        .search-box input { border: none; outline: none; flex: 1; font-size: 16px; margin-left: 10px; }
        .search-btns { margin-top: 25px; display: flex; gap: 10px; }
        .search-btn { background: #f8f9fa; border: 1px solid #f8f9fa; padding: 8px 16px; border-radius: 4px; color: #3c4043; cursor: pointer; font-size: 14px; }
        .search-btn:hover { box-shadow: 0 1px 1px rgba(0,0,0,0.1); border-color: #dadce0; color: #202124; }

        /* Results View */
        .chrome-results-view { align-items: flex-start; justify-content: flex-start; }
        .results-header { border-bottom: 1px solid #dfe1e5; w-full; padding: 15px; display: flex; items-center; gap: 20px; margin-bottom: 20px; }
        .results-content { padding: 0 20px 20px 20px; width: 100%; max-width: 800px; }
        .search-result-item { width: 100%; text-align: left; margin-bottom: 30px; animation: fadeIn 0.5s; }
        .result-url { color: #202124; font-size: 12px; margin-bottom: 2px; }
        .result-title { color: #1a0dab; font-size: 20px; cursor: pointer; text-decoration: none; display: block; margin-bottom: 4px; }
        .result-title:hover { text-decoration: underline; }
        .result-desc { color: #4d5156; font-size: 14px; line-height: 1.58; }
        
        /* YouTube View Styled Like Real App */
        .chrome-youtube-view { background: #f9f9f9; }
        .yt-sidebar-item { padding: 8px 12px; border-radius: 10px; cursor: pointer; display: flex; align-items: center; gap: 20px; font-size: 14px; color: #0f0f0f; }
        .yt-sidebar-item:hover { background-color: #f2f2f2; }
        .yt-sidebar-item i { width: 24px; font-size: 18px; text-align: center; }

        /* Fake Player Styles */
        .fake-player { 
            width: 100%; height: 100%; background: #000; 
            display: flex; align-items: center; justify-content: center; 
            cursor: pointer; position: relative; overflow: hidden;
        }
        .fake-player img { width: 100%; height: 100%; object-fit: cover; opacity: 0.7; transition: opacity 0.3s; }
        .fake-player:hover img { opacity: 0.5; }
        .play-btn-overlay {
            position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%);
            width: 68px; height: 48px; background: rgba(33, 33, 33, 0.8);
            border-radius: 12px; display: flex; align-items: center; justify-content: center;
            transition: background 0.2s;
        }
        .fake-player:hover .play-btn-overlay { background: #f00; }
        .play-triangle {
            width: 0; height: 0; border-style: solid; border-width: 10px 0 10px 18px;
            border-color: transparent transparent transparent #fff;
        }

        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }

        /* --- TASKBAR --- */
        .taskbar {
            position: absolute; bottom: 0; left: 0; width: 100%; height: 30px;
            background: linear-gradient(to bottom, #245edb 0%, #3f8cf3 10%, #245edb 15%, #245edb 85%, #1941a5 100%);
            display: flex; align-items: center; z-index: 10000; border-top: 1px solid #5a9ce9;
        }
        .start-button {
            height: 30px; background: linear-gradient(to bottom, #388e3c 0%, #81c784 10%, #388e3c 20%, #2e7d32 80%, #1b5e20 100%);
            border-radius: 0 10px 10px 0; padding: 0 15px 0 5px; display: flex; align-items: center;
            color: white; font-style: italic; font-weight: bold; font-size: 15px; cursor: pointer; margin-right: 10px; border: 1px solid #145214;
        }
        .system-tray { margin-left: auto; background: linear-gradient(to bottom, #1c7bbd 0%, #0d96f1 10%, #1c7bbd 20%, #1c7bbd 80%, #11568d 100%); height: 100%; padding: 0 15px; display: flex; align-items: center; color: white; font-size: 11px; border-left: 1px solid #0f4e8b; }

        .xp-button { padding: 4px 20px; background: #ece9d8; border: 1px solid #000; border-color: white #000 #000 white; font-size: 12px; cursor: pointer; }
        .xp-button:active { border-color: #000 white white #000; transform: translate(1px, 1px); }
        .hidden { display: none !important; }

        /* Effects */
        .heart { position: absolute; top: -50px; font-size: 20px; color: #ff3366; animation: fall linear forwards; z-index: 9998; pointer-events: none; }
        @keyframes fall { to { transform: translateY(110vh) rotate(360deg); } }
    </style>
</head>
<body>

    <!-- BOOT SCREEN -->
    <div id="boot-screen">
        <div id="boot-text"></div>
        <span class="cursor-blink">_</span>
    </div>

    <!-- BSOD -->
    <div id="bsod">
        <span style="background:white; color:blue; font-weight:bold;">Love_Exception</span>
        <p>A fatal exception LOVE has occurred at 0904:2004.</p>
        <p>Press any key to restart your heart.</p>
    </div>

    <!-- DESKTOP -->
    <div id="desktop">
        <div class="icon-grid">
            <div class="desktop-icon" onclick="openWindow('secret-window')">
                <i class="fas fa-folder xp-icon icon-folder"></i>
                <span class="font-bold text-yellow-200">CONFESSION</span>
            </div>
            
            <div class="desktop-icon" onclick="openWindow('snake-window'); initSnake();">
                <i class="fas fa-gamepad xp-icon icon-game"></i>
                <span>Rắn Săn Tình</span>
            </div>

            <div class="desktop-icon" onclick="openWindow('notepad-window')">
                <i class="fas fa-file-alt xp-icon icon-notepad"></i>
                <span>Nhật Ký.txt</span>
            </div>

            <!-- CHROME ICON -->
            <div class="desktop-icon" onclick="openWindow('chrome-window')">
                <div class="icon-chrome-bg xp-icon">
                    <i class="fab fa-chrome icon-chrome"></i>
                </div>
                <span>Chrome</span>
            </div>

            <div class="desktop-icon" onclick="openWindow('calc-window')">
                <i class="fas fa-calculator xp-icon icon-calc"></i>
                <span>Love Calc</span>
            </div>

            <div class="desktop-icon" onclick="openWindow('winamp-window')">
                <i class="fas fa-music xp-icon icon-music"></i>
                <span>Nhịp Tim</span>
            </div>

            <div class="desktop-icon" onclick="showError('My Computer', 'Lỗi: Hệ điều hành này chỉ chạy trên tim cậu thôi.')">
                <i class="fas fa-desktop xp-icon icon-computer"></i>
                <span>My Computer</span>
            </div>

            <div class="desktop-icon" onclick="showError('Recycle Bin', 'Không thể xóa em khỏi bộ nhớ!')">
                <i class="fas fa-trash-alt xp-icon icon-trash"></i>
                <span>Recycle Bin</span>
            </div>
        </div>

        <!-- 1. CONFESSION -->
        <div id="secret-window" class="window">
            <div class="window-header" onmousedown="startDrag(event, 'secret-window')">
                <div class="window-title"><i class="fas fa-terminal mr-2"></i> confession.exe</div>
                <div class="win-btn-close" onclick="closeWindow('secret-window')"><i class="fas fa-times"></i></div>
            </div>
            <div class="window-body">
                <div class="terminal-content">
                    <div id="typewriter-text" class="mb-6 whitespace-pre-wrap leading-relaxed"></div>
                    <div id="hidden-content" class="hidden flex flex-col items-center justify-center opacity-0 transition-opacity duration-1000 mt-4 pb-4">
                        <img src="https://images.unsplash.com/photo-1524504388940-b1c1722653e1?q=80&w=1887&auto=format&fit=crop" class="w-48 border-4 border-white transform rotate-2 mb-4">
                        <p class="text-center text-gray-400 text-xs font-mono mb-4">> Ngoại lệ chưa được xử lý...</p>
                        <div class="flex space-x-4">
                            <button class="xp-button font-bold text-blue-600" onclick="acceptLove()">Đồng ý</button>
                            <button class="xp-button" onclick="alert('Nút này bị liệt rồi!')">Từ chối</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 2. SNAKE GAME -->
        <div id="snake-window" class="window">
            <div class="window-header" onmousedown="startDrag(event, 'snake-window')">
                <div class="window-title">Rắn Săn Tình</div>
                <div class="win-btn-close" onclick="closeWindow('snake-window')"><i class="fas fa-times"></i></div>
            </div>
            <div class="window-body bg-gray-800 flex flex-col items-center pt-2">
                <div class="score-board">TIM ĐÃ ĂN: <span id="score">0</span></div>
                <canvas id="gameCanvas" width="280" height="280"></canvas>
                <p class="text-xs text-gray-400 mt-2 font-mono">Dùng mũi tên để di chuyển</p>
            </div>
        </div>

        <!-- 3. NOTEPAD -->
        <div id="notepad-window" class="window">
            <div class="window-header" onmousedown="startDrag(event, 'notepad-window')">
                <div class="window-title">Nhật Ký.txt - Notepad</div>
                <div class="win-btn-close" onclick="closeWindow('notepad-window')"><i class="fas fa-times"></i></div>
            </div>
            <div class="menu-bar">File &nbsp; Edit &nbsp; Format &nbsp; View &nbsp; Help</div>
            <div class="window-body">
                <textarea class="notepad-area">
Ngày... tháng... năm...

Gửi cậu, người chiếm 99% CPU của tớ.

Tớ định viết một thuật toán tối ưu hóa đường đi ngắn nhất đến trái tim cậu. Nhưng tớ nhận ra, biến số "nụ cười" của cậu làm tớ bị Stack Overflow mất rồi.

Đồng.
                </textarea>
            </div>
        </div>

        <!-- 4. CALCULATOR -->
        <div id="calc-window" class="window">
            <div class="window-header" onmousedown="startDrag(event, 'calc-window')">
                <div class="window-title">Love Calculator</div>
                <div class="win-btn-close" onclick="closeWindow('calc-window')"><i class="fas fa-times"></i></div>
            </div>
            <div class="calc-display" id="calc-res"></div>
            <div class="calc-grid">
                <button class="calc-btn text-red-600" onclick="clearCalc()">C</button>
                <button class="calc-btn" onclick="addCalc('/')">/</button>
                <button class="calc-btn" onclick="addCalc('*')">*</button>
                <button class="calc-btn" onclick="addCalc('-')">-</button>
                <button class="calc-btn" onclick="addCalc('7')">7</button>
                <button class="calc-btn" onclick="addCalc('8')">8</button>
                <button class="calc-btn" onclick="addCalc('9')">9</button>
                <button class="calc-btn" onclick="addCalc('+')">+</button>
                <button class="calc-btn" onclick="addCalc('4')">4</button>
                <button class="calc-btn" onclick="addCalc('5')">5</button>
                <button class="calc-btn" onclick="addCalc('6')">6</button>
                <button class="calc-btn" onclick="loveResult()">=</button>
                <button class="calc-btn" onclick="addCalc('1')">1</button>
                <button class="calc-btn" onclick="addCalc('2')">2</button>
                <button class="calc-btn" onclick="addCalc('3')">3</button>
                <button class="calc-btn" onclick="addCalc('0')">0</button>
            </div>
        </div>

        <!-- 5. WINAMP (CLEAN PLAYLIST ONLY) -->
        <div id="winamp-window" class="window">
            <div class="window-header" style="background: #333;" onmousedown="startDrag(event, 'winamp-window')">
                <div class="window-title" style="color: #0f0;">WINAMP - Love.mp3</div>
                <div class="win-btn-close" onclick="closeWindow('winamp-window')"><i class="fas fa-times"></i></div>
            </div>
            <div class="p-2 winamp-controls">
                
                <div class="text-[10px] text-green-400 font-mono mb-1">Đang phát:</div>
                <div id="song-title" class="song-title-display">...</div>

                <div class="winamp-visualizer" id="visualizer"></div>
                
                <!-- Giao diện sạch sẽ: Chỉ còn nút bấm -->
                <div class="flex justify-between items-center mt-3 px-2">
                    <div class="winamp-btn" onclick="prevSong()"><i class="fas fa-step-backward"></i></div>
                    <div class="winamp-btn play-btn" onclick="playMusic()"><i class="fas fa-play"></i></div>
                    <div class="winamp-btn" onclick="pauseMusic()"><i class="fas fa-pause"></i></div>
                    <div class="winamp-btn stop-btn" onclick="stopMusic()"><i class="fas fa-stop"></i></div>
                    <div class="winamp-btn" onclick="nextSong()"><i class="fas fa-step-forward"></i></div>
                </div>
                <!-- Audio Element -->
                <audio id="audio-player" onerror="handleAudioError()"></audio>
            </div>
        </div>

        <!-- 6. CHROME BROWSER (AUTOPLAY ENABLED) -->
        <div id="chrome-window" class="window">
            <div class="window-header" onmousedown="startDrag(event, 'chrome-window')">
                <div class="window-title">Google Chrome</div>
                <div class="win-btn-close" onclick="closeWindow('chrome-window')"><i class="fas fa-times"></i></div>
            </div>
            <div class="chrome-toolbar">
                <i class="fas fa-arrow-left text-gray-500 cursor-pointer" onclick="goHome()"></i>
                <i class="fas fa-arrow-right text-gray-500"></i>
                <i class="fas fa-redo text-gray-500 cursor-pointer" onclick="goHome()"></i>
                <div class="chrome-url-bar" id="chrome-url">https://www.google.com</div>
            </div>
            
            <div class="chrome-body">
                
                <!-- VIEW 1: SEARCH PAGE -->
                <div class="chrome-view chrome-search-view" id="view-search">
                    <div class="google-logo">
                        <span class="google-blue">G</span><span class="google-red">o</span><span class="google-yellow">o</span><span class="google-blue">g</span><span class="google-green">l</span><span class="google-red">e</span>
                    </div>
                    
                    <div class="search-box">
                        <i class="fas fa-search text-gray-400"></i>
                        <input type="text" id="google-input" placeholder="Tìm kiếm trên Google" onkeydown="if(event.key === 'Enter') doGoogleSearch()">
                        <i class="fas fa-microphone text-blue-500 cursor-pointer"></i>
                    </div>
                    
                    <div class="search-btns">
                        <button class="search-btn" onclick="doGoogleSearch()">Tìm với Google</button>
                        <button class="search-btn" onclick="alert('Đang cảm thấy may mắn vì có Đồng!')">Xem trang đầu tiên</button>
                    </div>

                    <div class="mt-8 flex gap-4 text-xs text-gray-500">
                        <div onclick="openYouTube()" class="flex items-center gap-1 hover:text-red-500 cursor-pointer text-gray-600 px-3 py-2 bg-gray-100 rounded-full">
                            <i class="fab fa-youtube text-red-600 text-lg"></i> YouTube
                        </div>
                    </div>
                </div>

                <!-- VIEW 2: RESULTS PAGE -->
                <div class="chrome-view chrome-results-view hidden-view" id="view-results">
                    <div class="results-header">
                         <div class="google-logo" style="font-size: 24px; margin:0; cursor:pointer;" onclick="goHome()">
                            <span class="google-blue">G</span><span class="google-red">o</span><span class="google-yellow">o</span><span class="google-blue">g</span><span class="google-green">l</span><span class="google-red">e</span>
                        </div>
                        <div class="flex-1 border rounded-full px-4 py-2 shadow-sm text-sm flex items-center">
                            <span id="result-bar-text" class="flex-1">...</span>
                            <i class="fas fa-search text-blue-500 cursor-pointer"></i>
                        </div>
                    </div>
                    
                    <div class="results-content">
                        <div class="text-gray-500 text-xs mb-4">Khoảng 1 kết quả (0.0904 giây)</div>
                        
                        <!-- THE ONLY RESULT -->
                        <div class="search-result-item">
                            <div class="result-url">https://profile.pham-chu-dong.vn > thong-tin-chi-tiet</div>
                            <div class="result-title text-blue-800 hover:underline">Phạm Chu Đồng - Hồ sơ bạn trai lý tưởng</div>
                            <div class="result-desc">
                                <b>Họ tên:</b> Phạm Chu Đồng<br>
                                <b>Sinh ngày:</b> 09/04/2004 (Cung Bạch Dương)<br>
                                <b>Thân hình:</b> Cao 1m77, nặng 70kg (Chuẩn người mẫu)<br>
                                <b>Học vấn:</b> Cựu học sinh THPT Nam Đông Quan, hiện là sinh viên ưu tú Tự động hóa - ĐH Mở Hà Nội.<br>
                                <b>Gia đình:</b> Con trai cả của Bố Định (1978) & Mẹ Hương (1984), anh trai của Tiến (2006).<br>
                                <b>Địa chỉ:</b> Số 12 ngách 8 ngõ 74 phố Đông Thiên, Vĩnh Hưng, Hoàng Mai, HN.<br>
                                <b>Sở thích:</b> Màu xanh dương và yêu em.<br>
                                <b>Tình trạng:</b> Đang chờ Trang.
                            </div>
                        </div>

                        <div class="search-result-item">
                            <div class="result-title text-lg text-blue-800 mt-4">Hình ảnh cho Phạm Chu Đồng</div>
                            <div class="flex gap-2 mt-2">
                                 <img src="https://images.unsplash.com/photo-1506794778202-cad84cf45f1d?q=80&w=100&h=100&auto=format&fit=crop" class="rounded">
                                 <img src="https://images.unsplash.com/photo-1519085360753-af0119f7cbe7?q=80&w=100&h=100&auto=format&fit=crop" class="rounded">
                                 <img src="https://images.unsplash.com/photo-1488161628813-99c974c76949?q=80&w=100&h=100&auto=format&fit=crop" class="rounded">
                            </div>
                        </div>
                    </div>
                </div>

                <!-- VIEW 3: YOUTUBE FAKE UI (AUTOPLAY ENABLED) -->
                <div class="chrome-view chrome-youtube-view hidden-view" id="view-youtube">
                    <!-- YT Header -->
                    <div class="bg-white px-4 py-2 flex items-center justify-between border-b border-gray-200">
                        <div class="flex items-center gap-4">
                            <i class="fas fa-bars text-gray-600 text-lg cursor-pointer"></i>
                            <div class="flex items-center gap-1 cursor-pointer" onclick="goHome()">
                                <i class="fab fa-youtube text-red-600 text-2xl"></i>
                                <span class="font-bold text-lg tracking-tighter relative -top-[1px]">YouTube</span>
                                <span class="text-[10px] text-gray-500 relative -top-2">VN</span>
                            </div>
                        </div>
                        <div class="flex items-center gap-4 flex-1 justify-center max-w-2xl">
                            <div class="flex w-full">
                                <input type="text" placeholder="Tìm kiếm" class="border border-gray-300 rounded-l-full px-4 py-1 w-full text-sm focus:border-blue-500 outline-none">
                                <button class="bg-gray-100 border border-l-0 border-gray-300 rounded-r-full px-4 py-1 hover:bg-gray-200">
                                    <i class="fas fa-search text-gray-600"></i>
                                </button>
                            </div>
                            <div class="bg-gray-100 p-2 rounded-full w-8 h-8 flex items-center justify-center cursor-pointer hover:bg-gray-200">
                                <i class="fas fa-microphone text-gray-800"></i>
                            </div>
                        </div>
                        <div class="flex items-center gap-4">
                            <i class="fas fa-video text-gray-600 text-lg cursor-pointer"></i>
                            <i class="fas fa-bell text-gray-600 text-lg cursor-pointer"></i>
                            <div class="w-8 h-8 bg-purple-600 rounded-full text-white flex items-center justify-center font-bold text-sm cursor-pointer">Đ</div>
                        </div>
                    </div>

                    <!-- YT Content -->
                    <div class="flex flex-1 overflow-hidden">
                        <!-- Sidebar -->
                        <div class="w-[200px] bg-white overflow-y-auto p-2 hidden md:block border-r border-gray-100">
                            <div class="flex flex-col gap-1">
                                <div class="yt-sidebar-item bg-gray-100 font-medium"><i class="fas fa-home"></i> <span>Trang chủ</span></div>
                                <div class="yt-sidebar-item"><i class="fas fa-bolt"></i> <span>Shorts</span></div>
                                <div class="yt-sidebar-item"><i class="fas fa-photo-video"></i> <span>Kênh đăng ký</span></div>
                                <hr class="my-2 border-gray-200">
                                <div class="px-3 py-2 font-bold text-sm">Bạn ></div>
                                <div class="yt-sidebar-item"><i class="fas fa-history"></i> <span>Video đã xem</span></div>
                                <div class="yt-sidebar-item"><i class="fas fa-clock"></i> <span>Xem sau</span></div>
                                <div class="yt-sidebar-item"><i class="fas fa-thumbs-up"></i> <span>Video đã thích</span></div>
                            </div>
                        </div>

                        <!-- Main Video Area -->
                        <div class="flex-1 bg-[#f9f9f9] p-6 overflow-y-auto">
                            <div class="flex flex-col lg:flex-row gap-6">
                                <!-- Main Player Container -->
                                <div class="flex-1">
                                    <div class="aspect-video bg-black rounded-xl overflow-hidden shadow-lg relative group" id="video-container">
                                        <!-- Fake Player (Click to Load) -->
                                        <div class="fake-player" onclick="loadRealVideo()">
                                            <img src="https://img.youtube.com/vi/vVhKA9Av6vA/maxresdefault.jpg" alt="Thumbnail">
                                            <div class="play-btn-overlay">
                                                <div class="play-triangle"></div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="mt-4">
                                        <h1 class="text-xl font-bold line-clamp-2" id="yt-video-title">'bao tiền một mớ bình yên?' - 14 Casper & Bon Nghiêm (Official) (Track 09 - Album 'SỐ KHÔNG')</h1>
                                        <div class="flex items-center justify-between mt-2">
                                            <div class="flex items-center gap-3">
                                                <div class="w-10 h-10 bg-gray-300 rounded-full overflow-hidden flex items-center justify-center">
                                                    <i class="fas fa-music text-gray-500"></i>
                                                </div>
                                                <div>
                                                    <div class="font-bold text-sm">Bon Nghiêm Official</div>
                                                    <div class="text-xs text-gray-500">10M người đăng ký</div>
                                                </div>
                                                <button class="bg-black text-white px-4 py-2 rounded-full text-sm font-bold ml-4 hover:bg-gray-800">Đăng ký</button>
                                            </div>
                                            <div class="flex items-center gap-2">
                                                <button class="bg-gray-100 px-3 py-2 rounded-l-full text-sm font-bold flex items-center gap-2 hover:bg-gray-200"><i class="far fa-thumbs-up"></i> 999K</button>
                                                <button class="bg-gray-100 px-3 py-2 rounded-r-full text-sm font-bold hover:bg-gray-200 border-l border-gray-300"><i class="far fa-thumbs-down"></i></button>
                                                <button class="bg-gray-100 px-3 py-2 rounded-full text-sm font-bold flex items-center gap-2 hover:bg-gray-200"><i class="fas fa-share"></i> Chia sẻ</button>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Recommended -->
                                <div class="w-full lg:w-[350px] flex flex-col gap-3">
                                    <div class="flex gap-2 cursor-pointer">
                                        <div class="w-[168px] h-[94px] bg-gray-200 rounded-lg flex-shrink-0 overflow-hidden relative">
                                            <img src="https://img.youtube.com/vi/S7ElVoYZN0g/mqdefault.jpg" class="w-full h-full object-cover">
                                            <span class="absolute bottom-1 right-1 bg-black bg-opacity-80 text-white text-[10px] px-1 rounded">3:45</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <h3 class="font-bold text-sm line-clamp-2">Top 10 sự thật về Phạm Chu Đồng mà bạn chưa biết</h3>
                                            <div class="text-xs text-gray-500 mt-1">Fact Vui</div>
                                            <div class="text-xs text-gray-500">100K lượt xem • 2 giờ trước</div>
                                        </div>
                                    </div>
                                    <div class="flex gap-2 cursor-pointer">
                                        <div class="w-[168px] h-[94px] bg-gray-200 rounded-lg flex-shrink-0 overflow-hidden relative">
                                            <img src="https://img.youtube.com/vi/7wtfhZwyrcc/mqdefault.jpg" class="w-full h-full object-cover">
                                            <span class="absolute bottom-1 right-1 bg-black bg-opacity-80 text-white text-[10px] px-1 rounded">10:02</span>
                                        </div>
                                        <div class="flex flex-col">
                                            <h3 class="font-bold text-sm line-clamp-2">Trang có yêu Đồng không?</h3>
                                            <div class="text-xs text-gray-500 mt-1">Phạm Chu Đồng</div>
                                            <div class="text-xs text-gray-500">0 lượt xem • vừa xong</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        <!-- TASKBAR -->
        <div class="taskbar">
            <div class="start-button" onclick="alert('Đường vào tim Đồng chỉ có một cửa thôi!')">
                <i class="fab fa-windows mr-1"></i>
                <span class="italic font-bold">start</span>
            </div>
            <div class="border-r border-white/20 h-4 mx-1"></div>
            <div class="system-tray">
                <div class="mr-3 cursor-pointer" ondblclick="alert('Thời gian bên nhau: Vô cực!')"><span id="clock">12:00</span></div>
            </div>
        </div>
    </div>

    <script>
        // --- BOOT ---
        const bootText = [ "Phoenix BIOS 4.0 Release 6.0", "CPU: Intel Pentium 4 2.8GHz", "Memory Test: 1048576K OK", "Detecting Love Drive... Found.", "Booting Windows XP..." ];
        let lineIdx = 0;
        function typeBoot() {
            if(lineIdx < bootText.length) {
                const d = document.createElement('div'); d.textContent = bootText[lineIdx++];
                document.getElementById('boot-text').appendChild(d);
                setTimeout(typeBoot, 150);
            } else { setTimeout(() => { document.getElementById('boot-screen').style.display='none'; document.getElementById('desktop').style.display='block'; }, 600); }
        }
        window.onload = typeBoot;

        // --- WINDOWS ---
        let highestZ = 1000;
        function openWindow(id) {
            const w = document.getElementById(id);
            w.style.display = 'flex'; w.style.zIndex = ++highestZ;
            if(id === 'secret-window' && document.getElementById('typewriter-text').innerHTML === "") typeConfession();
            
            // Reset Chrome if opening
            if(id === 'chrome-window') {
                if(document.getElementById('view-search').classList.contains('hidden-view') && 
                   document.getElementById('view-results').classList.contains('hidden-view') &&
                   document.getElementById('view-youtube').classList.contains('hidden-view')) {
                    goHome();
                }
            }
        }
        
        function closeWindow(id) { 
            document.getElementById(id).style.display = 'none'; 
            if (id === 'winamp-window') stopMusic();
            if (id === 'chrome-window') goHome(); 
        }
        
        function showError(t, m) { alert(`${t}\n\n${m}`); }

        // --- DRAG ---
        let dragItem = null; let offsetX = 0; let offsetY = 0;
        function startDrag(e, id) {
            dragItem = document.getElementById(id); dragItem.style.zIndex = ++highestZ;
            const rect = dragItem.getBoundingClientRect(); offsetX = e.clientX - rect.left; offsetY = e.clientY - rect.top;
            document.addEventListener('mousemove', doDrag); document.addEventListener('mouseup', stopDrag);
        }
        function doDrag(e) {
            if(!dragItem) return;
            dragItem.style.left = (e.clientX - offsetX) + 'px'; dragItem.style.top = (e.clientY - offsetY) + 'px';
            dragItem.style.transform = 'none';
        }
        function stopDrag() { document.removeEventListener('mousemove', doDrag); document.removeEventListener('mouseup', stopDrag); dragItem = null; }

        // --- CONFESSION ---
        const msg = "Chào cậu.\n\nTớ là Đồng.\nNgành Tự động hóa dạy tớ về điều khiển hệ thống, nhưng tớ chịu chết không điều khiển được nhịp tim khi gặp cậu.\n\nTớ có cái này muốn hỏi...";
        let charIdx = 0;
        function typeConfession() {
            if(charIdx < msg.length) { document.getElementById('typewriter-text').textContent += msg.charAt(charIdx++); setTimeout(typeConfession, 40); }
            else { setTimeout(() => { document.getElementById('hidden-content').classList.remove('hidden', 'opacity-0'); }, 500); }
        }
        function acceptLove() {
            closeWindow('secret-window');
            document.getElementById('desktop').style.background = 'linear-gradient(45deg, #ff9a9e 0%, #fad0c4 99%, #fad0c4 100%)';
            setInterval(() => {
                const h = document.createElement('div'); h.className = 'heart'; h.innerHTML = '❤️';
                h.style.left = Math.random()*100+'vw'; h.style.fontSize = (Math.random()*20+10)+'px'; h.style.animationDuration = (Math.random()*3+2)+'s';
                document.getElementById('desktop').appendChild(h); setTimeout(() => h.remove(), 5000);
            }, 200);
            alert("Hệ thống ghi nhận: LOVE_GRANTED!");
        }

        // --- SNAKE ---
        const cvs = document.getElementById('gameCanvas'); const ctx = cvs.getContext('2d');
        const box = 20; let snake = []; let food = {}; let d; let game; let score = 0;
        function initSnake() {
            clearInterval(game); snake = [{x: 9*box, y: 10*box}]; food = {x: Math.floor(Math.random()*14)*box, y: Math.floor(Math.random()*14)*box};
            score = 0; d = undefined; document.getElementById('score').innerText = score;
            document.addEventListener("keydown", direction);
            game = setInterval(drawSnake, 200);
        }
        function direction(event) {
            if(event.keyCode == 37 && d != "RIGHT") d = "LEFT";
            else if(event.keyCode == 38 && d != "DOWN") d = "UP";
            else if(event.keyCode == 39 && d != "LEFT") d = "RIGHT";
            else if(event.keyCode == 40 && d != "UP") d = "DOWN";
        }
        function drawSnake() {
            ctx.fillStyle = "#222"; ctx.fillRect(0,0,280,280);
            for(let i=0; i<snake.length; i++) {
                ctx.fillStyle = (i == 0) ? "#0f0" : "white"; ctx.fillRect(snake[i].x, snake[i].y, box, box);
                ctx.strokeStyle = "red"; ctx.strokeRect(snake[i].x, snake[i].y, box, box);
            }
            ctx.fillStyle = "red"; ctx.font = "20px Arial"; ctx.fillText("❤", food.x+2, food.y+18);
            let snakeX = snake[0].x; let snakeY = snake[0].y;
            if(d == "LEFT") snakeX -= box; if(d == "UP") snakeY -= box;
            if(d == "RIGHT") snakeX += box; if(d == "DOWN") snakeY += box;
            if(snakeX == food.x && snakeY == food.y) { score++; document.getElementById('score').innerText = score; food = {x: Math.floor(Math.random()*14)*box, y: Math.floor(Math.random()*14)*box}; } else { snake.pop(); }
            if(snakeX < 0) snakeX = 260; if(snakeX > 260) snakeX = 0; if(snakeY < 0) snakeY = 260; if(snakeY > 260) snakeY = 0;
            snake.unshift({x:snakeX, y:snakeY});
        }

        // --- CALCULATOR ---
        function addCalc(val) { document.getElementById('calc-res').innerText += val; }
        function clearCalc() { document.getElementById('calc-res').innerText = ''; }
        function loveResult() { document.getElementById('calc-res').innerText = '09/04/2004'; }

        // --- CHROME LOGIC (UPDATED) ---
        function showView(viewId) {
            document.querySelectorAll('.chrome-view').forEach(el => el.classList.add('hidden-view'));
            document.getElementById(viewId).classList.remove('hidden-view');
        }

        function goHome() {
            showView('view-search');
            document.getElementById('chrome-url').innerText = "https://www.google.com";
            document.getElementById('google-input').value = "";
            // Reset player to image when going home
            document.getElementById('video-container').innerHTML = `
                <div class="fake-player" onclick="loadRealVideo()">
                    <img src="https://img.youtube.com/vi/vVhKA9Av6vA/maxresdefault.jpg" alt="Thumbnail">
                    <div class="play-btn-overlay">
                        <div class="play-triangle"></div>
                    </div>
                </div>`;
        }

        function doGoogleSearch() {
            const val = document.getElementById('google-input').value.trim();
            if(!val) return;
            showView('view-results');
            document.getElementById('result-bar-text').innerText = val;
            document.getElementById('chrome-url').innerText = "https://www.google.com/search?q=" + encodeURIComponent(val);
        }

        // LOAD VIDEO FIX LỖI 153 (DÙNG DẠNG PLAYLIST MIX)
        function loadRealVideo() {
            const container = document.getElementById('video-container');
            // Trick: Dùng link có tham số list=RD... để lách luật chặn nhúng đơn lẻ
            container.innerHTML = `
                <iframe width="100%" height="100%" 
                    src="https://www.youtube.com/embed/vVhKA9Av6vA?list=RDvVhKA9Av6vA&autoplay=1" 
                    title="YouTube video player" 
                    frameborder="0" 
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" 
                    allowfullscreen>
                </iframe>`;
        }

        function openYouTube() { 
            showView('view-youtube');
            document.getElementById('chrome-url').innerText = "https://www.youtube.com/watch?v=vVhKA9Av6vA";
        }

        // --- WINAMP MUSIC LOGIC (PLAYLIST VERSION with Drive Support) ---
        
        // =========================================================================
        // ĐỒNG ƠI! DÁN LINK NHẠC VÀO ĐÂY (HỖ TRỢ LINK GOOGLE DRIVE):
        // =========================================================================
        const playlist = [
            {
                title: "1. Demo Chill (Link mẫu)",
                src: "https://cdn.pixabay.com/download/audio/2022/05/27/audio_1808fbf07a.mp3"
            },
            {
                title: "2. Secret",
                src: "https://drive.google.com/file/d/1ElGoGLAUQKorIA354XBMQTezXC9MdeuW/view?usp=drive_link"
            },
            // Ví dụ link Google Drive (Nhớ mở quyền 'Anyone with the link'):
            // { title: "3. Tên Bài Hát", src: "https://drive.google.com/file/d/1A2B3C.../view?usp=sharing" }
        ];
        // =========================================================================

        let currentTrackIndex = 0;
        let audio = document.getElementById('audio-player');
        let visInterval;
        let isPlaying = false;

        document.getElementById('song-title').innerText = playlist[currentTrackIndex].title;

        // Hàm chuyển đổi link Drive thành direct link
        function getDirectDriveLink(url) {
            if (!url) return url;
            if (url.includes('drive.google.com')) {
                let fileId = null;
                // Match /d/ID/ or id=ID
                const match1 = url.match(/\/d\/([a-zA-Z0-9_-]+)/);
                const match2 = url.match(/id=([a-zA-Z0-9_-]+)/);
                
                if (match1) fileId = match1[1];
                else if (match2) fileId = match2[1];
                
                if (fileId) {
                    return `https://drive.google.com/uc?export=download&id=${fileId}`;
                }
            }
            return url;
        }

        function handleAudioError() {
            stopVisualizer();
            // Chỉ hiện alert nếu đang cố gắng phát (tránh lỗi khi mới load trang)
            if (isPlaying) {
                alert("Lỗi phát nhạc! Có thể do:\n1. Link Google Drive chưa mở quyền 'Public' (Anyone with the link).\n2. Link MP3 bị chặn.\n\nĐang chuyển sang bài tiếp theo...");
                nextSong(); // Auto skip lỗi
            }
            isPlaying = false;
        }

        function loadTrack(index) {
            if (index >= 0 && index < playlist.length) {
                currentTrackIndex = index;
                const rawSrc = playlist[index].src;
                const directSrc = getDirectDriveLink(rawSrc); // Xử lý link Drive
                
                audio.src = directSrc;
                document.getElementById('song-title').innerText = playlist[index].title;
                
                if (isPlaying) {
                    playMusic();
                }
            }
        }

        function playMusic() {
            if (!audio.src) {
                // Load bài đầu tiên nếu chưa có
                loadTrack(currentTrackIndex);
            }
            
            const playPromise = audio.play();
            if (playPromise !== undefined) {
                playPromise.then(_ => {
                    isPlaying = true;
                    startVisualizer();
                })
                .catch(error => {
                    console.log("Play error:", error);
                    // Lỗi sẽ được xử lý ở onError
                });
            }
        }
        
        function pauseMusic() { 
            audio.pause(); 
            isPlaying = false;
            stopVisualizer(); 
        }
        
        function stopMusic() { 
            audio.pause(); 
            audio.currentTime = 0; 
            isPlaying = false;
            stopVisualizer(); 
        }

        function nextSong() {
            let nextIndex = currentTrackIndex + 1;
            if (nextIndex >= playlist.length) nextIndex = 0; 
            loadTrack(nextIndex);
            playMusic();
        }

        function prevSong() {
            let prevIndex = currentTrackIndex - 1;
            if (prevIndex < 0) prevIndex = playlist.length - 1;
            loadTrack(prevIndex);
            playMusic();
        }

        audio.onended = function() {
            nextSong();
        };

        function startVisualizer() {
            const c = document.getElementById('visualizer'); c.innerHTML = '';
            for(let i=0; i<20; i++) {
                const b = document.createElement('div'); b.className = 'bar';
                b.style.height = '10px'; b.style.width = '10px'; c.appendChild(b);
            }
            clearInterval(visInterval);
            visInterval = setInterval(() => {
                const bars = document.querySelectorAll('.bar');
                bars.forEach(b => { b.style.height = Math.floor(Math.random()*30+5)+'px'; });
            }, 100);
        }
        function stopVisualizer() { clearInterval(visInterval); }

        // --- EASTER EGG ---
        const konami = ["ArrowUp","ArrowUp","ArrowDown","ArrowDown","ArrowLeft","ArrowRight","ArrowLeft","ArrowRight","b","a"];
        let kIdx = 0;
        document.addEventListener('keydown', (e) => { if(e.key === konami[kIdx]) { kIdx++; if(kIdx === konami.length) { document.getElementById('bsod').style.display = 'block'; kIdx = 0; } } else { kIdx = 0; } });
        document.getElementById('bsod').addEventListener('click', function() { this.style.display = 'none'; });

        // --- CLOCK ---
        setInterval(() => { const d = new Date(); document.getElementById('clock').innerText = d.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'}); }, 1000);

    </script>
</body>
</html>
